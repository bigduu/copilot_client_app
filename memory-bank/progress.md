# 项目进展

## 已完成功能

- **核心应用框架**:
  - 基于Tauri、React和Rust的项目结构已经建立。
  - 前端和后端之间的基本通信桥梁已搭建完成。
- **聊天界面**:
  - 基本的聊天视图和消息输入组件已实现。
- **工具系统 (初步)**:
  - 后端 `tool_system` crate 已创建，用于管理和执行工具。
  - 实现了如 `read_file`, `write_to_file` 等基本的文件系统工具。
- **记忆银行 (初始化)**:
  - 记忆银行的核心文档结构已创建。

## 已完成功能 (最近更新)

- **架构重构 (2025-10-19)**:
  - **后端**: 实现了统一的、基于 `thiserror` 和 `ResponseError` trait 的错误处理架构，提高了后端的健壮性。
  - **前端**:
    - 优化了输入组件的状态管理，解决了 AI 思考时 UI 完全锁定的问题，提升了用户体验。
    - 对 `MessageInput` 组件进行了重构，将图片、拖放和粘贴逻辑提取到独立的自定义 Hooks 中，提高了代码的可维护性和复用性。
  - **文档**: 更新了技术和系统模式文档，以反映最新的架构决策。

## 待办功能

- **完善工具集**:
  - 增加更多工具，如 `search_files`, `browser_action` 等。
  - 完善MCP（模型上下文协议）客户端，以支持可扩展的外部工具。
- **增强用户体验**:
  - 实现系统提示词选择器。
  - 增加收藏夹功能。
  - 进一步优化附件处理和图片预览。
- **健壮性与错误处理**:
  - 在前端实现更细粒度的错误展示，以利用后端返回的结构化错误信息。
  - 完善审批流程，确保操作的安全性。
- **状态管理优化**:
  - 持续优化 `chatInteractionMachine` 状态机，以处理更复杂的交互场景。

## 已知问题

- **终端输出流**: 在执行长时间运行的命令时，终端输出可能无法实时流式传输回前端。
- **上下文窗口限制**: 对于非常大的项目或长时间的对话，可能会达到LLM的上下文窗口限制。

## 项目决策演变

- **通信方式演变**: 项目最初严重依赖Tauri的 `invoke` 机制进行前后端通信。后来，架构演变为在Tauri应用内部启动一个本地的 `actix-web` 服务器。现在，前端主要通过HTTP请求与这个本地服务器交互，将核心业务逻辑与桌面框架解耦，同时保留Tauri用于处理原生操作系统交互（如剪贴板）。
- **工具系统演变**: 最初，项目可能依赖于一组硬编码的工具。决策已转向使用一个更灵活、可扩展的工具系统，最终通过MCP支持外部工具服务器。
- **状态管理演变**: 状态管理从简单的React state演变为使用XState，以更好地处理复杂的UI交互逻辑。
