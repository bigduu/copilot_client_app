# 项目进展

## 已完成功能

- **核心应用框架**:
  - 基于Tauri、React和Rust的项目结构已经建立。
  - 前端和后端之间的通信桥梁已从 `invoke` 演变为基于 `actix-web` 的本地HTTP服务。
- **聊天界面**:
  - 实现了聊天视图、消息输入、Markdown渲染和Mermaid图表支持。
- **工具系统**:
  - 后端 `tool_system` crate 已创建，用于管理和执行工具。
  - 实现了 `read_file`, `write_to_file`, `list_files`, `execute_command` 等核心工具。
  - 实现了动态将可用工具注入到System Prompt中的机制。
- **记忆银行**:
  - 记忆银行的核心文档结构已创建并投入使用。
- **用户自定义System Prompts**:
  - 实现了完整的UI (`SystemPromptManager`)，允许用户创建、读取、更新和删除他们自己的prompts。
  - 使用 `localStorage` 进行客户端持久化。
- **架构和重构**:
  - 后端实现了统一的错误处理架构。
  - 前端通过自定义Hooks和Zustand slices实现了状态管理的模块化。
  - 后端通过`crates`实现了逻辑的模块化。

## 待办功能

- **完善工具集**:
  - **实现 `get_mcp_tools`**: 在 Rust 后端实现 `get_mcp_tools` tauri 命令，以将 MCP 工具也动态注入到 prompt 中。
  - 增加 `search_files` 和 `browser_action` 工具的完整功能。
- **增强用户体验**:
  - 增加收藏夹功能。
  - 进一步优化附件处理和图片预览。
- **健壮性与错误处理**:
  - 在前端实现更细粒度的错误展示。
  - 完善审批流程，确保操作的安全性。
- **状态管理优化**:
  - 持续优化 `chatInteractionMachine` 状态机，以处理更复杂的交互场景。

## 已知问题

- **终端输出流**: 在执行长时间运行的命令时，终端输出可能无法实时流式传输回前端。
- **上下文窗口限制**: 对于非常大的项目或长时间的对话，可能会达到LLM的上下文窗口限制。

## 项目决策演变

- **通信方式演变**: 项目最初严重依赖Tauri的 `invoke` 机制。架构现已演变为在Tauri应用内部启动一个本地的 `actix-web` 服务器。前端主要通过HTTP请求与这个本地服务器交互，将核心业务逻辑与桌面框架解耦。
- **工具系统演变**: 从一组硬编码的工具，演变为一个灵活、可扩展的工具系统，并计划通过MCP支持外部工具。
- **状态管理演变**: 状态管理从简单的React state演变为使用XState和Zustand，以更好地处理复杂的UI交互逻辑和模块化状态。
- **Prompt 管理演变**: System Prompts 从后端硬编码的概念，演变为完全由用户在客户端管理的、独立的实体。工具的可用性现在是动态的，在运行时注入。
